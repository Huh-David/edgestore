---
id: getting-started
title: Getting Started
sidebar_label: Getting Started
slug: /getting-started
---

# Getting Started

### Next.js Setup

#### Install

```shell
npm install @edge-store/react
```

#### Environment Variables

```shell title=".env"
EDGE_STORE_ACCESS_KEY=your-access-key
EDGE_STORE_SECRET_KEY=your-secret-key
```

#### API Route

```jsx title="pages/api/edgestore/[...edgestore].ts"
import EdgeStore from '@edge-store/react/next';

export default EdgeStore();
```

#### Provider

```jsx title="pages/_app.tsx"
import { EdgeStoreProvider } from '@edge-store/react';

export default function App({ Component, pageProps }) {
  return (
    <EdgeStoreProvider>
      <Component {...pageProps} />
    </EdgeStoreProvider>
  );
}
```

### Upload image

You can use the `useEdgeStore` hook to access the upload function.
There are two available options for the upload function:
`uploadImage` and `uploadProtectedImage`.
Both work the same way, but `uploadProtectedImage` will only be accessible with a temporary token that is automatically generated by Edge Store from within your app.

```ts twoslash
// @noErrors
import { initEdgeStore } from '@edge-store/server';
import {
  createEdgeStoreNextHandler,
  CreateNextContextOptions,
} from '@edge-store/server/adapters/next';
import { initEdgeStoreClient } from '@edge-store/server/core';
import { z } from 'zod';

type Context = {
  userId: string;
  userRole: 'admin' | 'visitor';
};

function createContext(_opts: CreateNextContextOptions): Context {
  return {
    userId: '123',
    userRole: 'admin',
  };
}

const es = initEdgeStore.context<Context>().create();
// ---cut---
const imagesBucket = es.imageBucket
  .input(
    z.object({
      type: z.enum(['profile', 'post']),
      extension: z.string().optional(),
    }),
  )
  .path(({ ctx, input }) => [{ author: ctx.userId }, { type: input.type }])
  .metadata(({ ctx, input }) => ({
    extension: input.extension,
    //                 ^?
    role: ctx.u
    //         ^|
  }));
```

```jsx
import { useEdgeStore } from '@edge-store/react';

const Page = () => {
  const [file, setFile] = useState(null);
  const { uploadImage } = useEdgeStore();

  return (
    <div>
      <input type="file" onChange={(e) => setFile(e.target.files[0])} />
      <button
        onClick={async () => {
          const { url } = await uploadImage(file, {
            onProgressChange: (progress) => {
              console.log(progress);
            },
          });
          console.log(url);
        }}
      >
        Upload
      </button>
    </div>
  );
};

export default Page;
```

### Show image

```jsx
import { useEdgeStore } from '@edge-store/react';

const Page = () => {
  const { getImgSrc } = useEdgeStore();

  return (
    <div>
      <img src={getImgSrc('https://my-image-domain.com/path/to/image.jpg')} />
    </div>
  );
};
```
