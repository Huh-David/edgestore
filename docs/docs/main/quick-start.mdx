---
id: quick-start
title: Quick Start
sidebar_label: Quick Start
slug: /quick-start
---

import TabItem from '@theme/TabItem';
import Tabs from '@theme/Tabs';

# Quick Start

## Next.js Setup

### Install

Let's start by installing the required packages.

<Tabs>
<TabItem value="npm" label="npm">

```shell
npm install @edgestore/server @edgestore/react zod
```

</TabItem>
<TabItem value="pnpm" label="pnpm">

```shell
pnpm add @edgestore/server @edgestore/react zod
```

</TabItem>
<TabItem value="yarn" label="yarn">

```shell
yarn add @edgestore/server @edgestore/react zod
```

</TabItem>
</Tabs>

### Environment Variables

Then go to your [Dashboard](https://edgestore.dev/dashboard), create a new project and copy the keys to your environment variables.

```shell title=".env"
EDGE_STORE_ACCESS_KEY=your-access-key
EDGE_STORE_SECRET_KEY=your-secret-key
```

### Backend

Now we can create the backend code for our Next.js app.<br/>
Edge Store is compatible with both types of Next.js apps (`pages router` and `app router`).

The example below is the simplest bucket you can create with Edge Store. Just a simple file bucket with no validation that will be accessible by anyone with the link.

You can have multiple buckets in your app, each with its own configuration.

<Tabs>
<TabItem value="app" label="app">

```tsx title="src/app/api/edgestore/[...edgestore]/route.ts"
import { initEdgeStore } from '@edgestore/server';
import { createEdgeStoreNextHandler } from '@edgestore/server/adapters/next/app';

const es = initEdgeStore.context().create();

/**
 * This is the main router for the edgestore buckets.
 */
const edgeStoreRouter = es.router({
  myPublicFiles: es.fileBucket,
});

const handler = createEdgeStoreNextHandler({
  router: edgeStoreRouter,
});

export { handler as GET, handler as POST };

/**
 * This type is used to create the type-safe client for the frontend.
 */
export type EdgeStoreRouter = typeof edgeStoreRouter;
```

</TabItem>
<TabItem value="pages" label="pages">

```tsx title="src/pages/api/edgestore/[...edgestore].ts"
import { initEdgeStore } from '@edgestore/server';
import { createEdgeStoreNextHandler } from '@edgestore/server/adapters/next/pages';

const es = initEdgeStore.context().create();

/**
 * This is the main router for the edgestore buckets.
 */
const edgeStoreRouter = es.router({
  myPublicFiles: es.fileBucket,
});

export default createEdgeStoreNextHandler({
  router: edgeStoreRouter,
});

/**
 * This type is used to create the type-safe client for the frontend.
 */
export type EdgeStoreRouter = typeof edgeStoreRouter;
```

</TabItem>
</Tabs>

### Frontend

Now let's initiate our context provider.

<Tabs>
<TabItem value="app" label="app">

```tsx title="src/lib/edgestore.ts"
'use client';

import { EdgeStoreRouter } from '@/app/api/edgestore/[...edgestore]/route';
import { createEdgeStoreProvider } from '@edgestore/react';

const { EdgeStoreProvider, useEdgeStore } =
  createEdgeStoreProvider<EdgeStoreRouter>();

export { EdgeStoreProvider, useEdgeStore };
```

</TabItem>
<TabItem value="pages" label="pages">

```tsx title="src/lib/edgestore.ts"
'use client';

import { EdgeStoreRouter } from '@/pages/api/edgestore/[...edgestore]';
import { createEdgeStoreProvider } from '@edgestore/react';

const { EdgeStoreProvider, useEdgeStore } =
  createEdgeStoreProvider<EdgeStoreRouter>();

export { EdgeStoreProvider, useEdgeStore };
```

</TabItem>
</Tabs>

And then wrap our app with the provider.

<Tabs>
<TabItem value="app" label="app">

```tsx {0, 13} title="src/app/layout.tsx"
import { EdgeStoreProvider } from '@/lib/edgestore';
import './globals.css';

// ...

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body>
        <EdgeStoreProvider>{children}</EdgeStoreProvider>
      </body>
    </html>
  );
}
```

</TabItem>
<TabItem value="pages" label="pages">

```tsx {2, 6, 8} title="src/pages/_app.tsx"
import '@/styles/globals.css';
import type { AppProps } from 'next/app';
import { EdgeStoreProvider } from '@/lib/edgestore';

export default function App({ Component, pageProps }: AppProps) {
  return (
    <EdgeStoreProvider>
      <Component {...pageProps} />
    </EdgeStoreProvider>
  );
}

```

</TabItem>
</Tabs>

### Upload image

You can use the `useEdgeStore` hook to access the upload function.
There are two available options for the upload function:
`uploadImage` and `uploadProtectedImage`.
Both work the same way, but `uploadProtectedImage` will only be accessible with a temporary token that is automatically generated by Edge Store from within your app.

```ts twoslash
// @noErrors
import { initEdgeStore } from '@edgestore/server';
import {
  CreateContextOptions,
  createEdgeStoreNextHandler,
} from '@edgestore/server/adapters/next/pages';
import { initEdgeStoreClient } from '@edgestore/server/core';
import { z } from 'zod';

type Context = {
  userId: string;
  userRole: 'admin' | 'visitor';
};

function createContext(_opts: CreateContextOptions): Context {
  return {
    userId: '123',
    userRole: 'admin',
  };
}

const es = initEdgeStore.context<Context>().create();
// ---cut---
const imagesBucket = es.imageBucket
  .input(
    z.object({
      type: z.enum(['profile', 'post']),
      extension: z.string().optional(),
    }),
  )
  .path(({ ctx, input }) => [{ author: ctx.userId }, { type: input.type }])
  .metadata(({ ctx, input }) => ({
    extension: input.extension,
    //                 ^?
    role: ctx.u,
    //         ^|
  }));
```

```jsx
import { useEdgeStore } from '@edgestore/react';

const Page = () => {
  const [file, setFile] = useState(null);
  const { uploadImage } = useEdgeStore();

  return (
    <div>
      <input type="file" onChange={(e) => setFile(e.target.files[0])} />
      <button
        onClick={async () => {
          const { url } = await uploadImage(file, {
            onProgressChange: (progress) => {
              console.log(progress);
            },
          });
          console.log(url);
        }}
      >
        Upload
      </button>
    </div>
  );
};

export default Page;
```

### Show image

```jsx
import { useEdgeStore } from '@edgestore/react';

const Page = () => {
  const { getImgSrc } = useEdgeStore();

  return (
    <div>
      <img src={getImgSrc('https://my-image-domain.com/path/to/image.jpg')} />
    </div>
  );
};
```
